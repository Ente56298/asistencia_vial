<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluación Espiritual y Trascendental - CO•RA</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: radial-gradient(circle at center, #9b59b6, #8e44ad);
            color: #ffffff;
            font-family: 'Arial', sans-serif;
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(0,0,0,0.9);
            border-radius: 25px;
            padding: 40px;
            border: 3px solid #9b59b6;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .title {
            color: #9b59b6;
            font-size: 2.2rem;
            margin-bottom: 15px;
        }
        .spiritual-area {
            background: rgba(155, 89, 182, 0.1);
            border: 2px solid #9b59b6;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            display: none;
        }
        .spiritual-area.active {
            display: block;
            animation: areaIn 0.8s ease-out;
        }
        @keyframes areaIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .area-title {
            color: #9b59b6;
            font-size: 1.5rem;
            margin-bottom: 20px;
        }
        .spiritual-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 25px 0;
            background: rgba(0,0,0,0.8);
            border-radius: 15px;
            padding: 20px;
        }
        .spiritual-metric {
            text-align: center;
            padding: 15px;
            background: rgba(155, 89, 182, 0.2);
            border-radius: 10px;
            border: 1px solid #9b59b6;
        }
        .metric-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #9b59b6;
            margin-bottom: 5px;
        }
        .metric-label {
            font-size: 0.9rem;
            color: #bb8fce;
        }
        .spiritual-question {
            background: rgba(0,0,0,0.6);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border-left: 4px solid #bb8fce;
        }
        .question-text {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 20px;
        }
        .spiritual-options {
            display: grid;
            gap: 12px;
        }
        .spiritual-option {
            background: rgba(187, 143, 206, 0.2);
            border: 2px solid #bb8fce;
            color: #ffffff;
            padding: 15px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
        }
        .spiritual-option:hover {
            background: rgba(155, 89, 182, 0.3);
            border-color: #9b59b6;
            transform: translateX(5px);
        }
        .spiritual-option.selected {
            background: rgba(155, 89, 182, 0.5);
            border-color: #ffffff;
        }
        .values-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .value-item {
            background: rgba(155, 89, 182, 0.2);
            border: 2px solid #bb8fce;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        .value-item:hover {
            background: rgba(155, 89, 182, 0.3);
        }
        .value-item.selected {
            background: rgba(155, 89, 182, 0.5);
            border-color: #ffffff;
        }
        .reflection-input {
            width: 100%;
            min-height: 120px;
            background: rgba(0,0,0,0.6);
            border: 2px solid #bb8fce;
            border-radius: 10px;
            color: #ffffff;
            padding: 15px;
            font-size: 1rem;
            resize: vertical;
        }
        .results-container {
            display: none;
            background: rgba(0,0,0,0.95);
            border: 3px solid #9b59b6;
            border-radius: 25px;
            padding: 40px;
            margin-top: 30px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">🌟 Evaluación Espiritual y Trascendental CO•RA</h1>
            <p style="color: #bb8fce; margin-bottom: 20px;">
                Evaluación de sentido de vida, valores, ética, propósito y conexión con algo más grande que uno mismo
            </p>
        </div>

        <div class="spiritual-dashboard" id="spiritualDashboard">
            <div class="spiritual-metric">
                <div class="metric-value" id="purposeScore">0</div>
                <div class="metric-label">Sentido Vida</div>
            </div>
            <div class="spiritual-metric">
                <div class="metric-value" id="valuesScore">0</div>
                <div class="metric-label">Valores Éticos</div>
            </div>
            <div class="spiritual-metric">
                <div class="metric-value" id="transcendenceScore">0</div>
                <div class="metric-label">Trascendencia</div>
            </div>
            <div class="spiritual-metric">
                <div class="metric-value" id="wisdomScore">0</div>
                <div class="metric-label">Sabiduría</div>
            </div>
            <div class="spiritual-metric">
                <div class="metric-value" id="serviceScore">0</div>
                <div class="metric-label">Servicio</div>
            </div>
        </div>

        <!-- Test 1: Sentido de Vida (Purpose in Life Test) -->
        <div class="spiritual-area active" id="area1">
            <h2 class="area-title">Test 1: Sentido de Vida (Crumbaugh & Maholick)</h2>
            <div class="spiritual-question">
                <div class="question-text">
                    ¿Qué tan claro tienes tu propósito de vida y el significado de tu existencia?
                </div>
                <div class="spiritual-options">
                    <div class="spiritual-option" onclick="selectSpiritual(1, 1)" data-score="100">
                        Tengo un propósito de vida muy claro y significativo que guía todas mis decisiones
                    </div>
                    <div class="spiritual-option" onclick="selectSpiritual(1, 2)" data-score="80">
                        Generalmente sé hacia dónde voy en la vida y qué es importante para mí
                    </div>
                    <div class="spiritual-option" onclick="selectSpiritual(1, 3)" data-score="60">
                        Tengo algunas ideas sobre mi propósito pero aún estoy explorando
                    </div>
                    <div class="spiritual-option" onclick="selectSpiritual(1, 4)" data-score="40">
                        A menudo me pregunto cuál es el sentido de mi vida y qué debería hacer
                    </div>
                    <div class="spiritual-option" onclick="selectSpiritual(1, 5)" data-score="20">
                        Me siento perdido y sin un propósito claro en la vida
                    </div>
                </div>
            </div>
        </div>

        <!-- Test 2: Valores Fundamentales (Schwartz) -->
        <div class="spiritual-area" id="area2">
            <h2 class="area-title">Test 2: Jerarquía de Valores (Schwartz)</h2>
            <div class="spiritual-question">
                <div class="question-text">
                    Selecciona los 3 valores más importantes que guían tu vida:
                </div>
                <div class="values-grid" id="valuesGrid">
                    <div class="value-item" onclick="selectValue(this)" data-value="wisdom">Sabiduría</div>
                    <div class="value-item" onclick="selectValue(this)" data-value="justice">Justicia</div>
                    <div class="value-item" onclick="selectValue(this)" data-value="compassion">Compasión</div>
                    <div class="value-item" onclick="selectValue(this)" data-value="truth">Verdad</div>
                    <div class="value-item" onclick="selectValue(this)" data-value="service">Servicio</div>
                    <div class="value-item" onclick="selectValue(this)" data-value="growth">Crecimiento</div>
                    <div class="value-item" onclick="selectValue(this)" data-value="harmony">Armonía</div>
                    <div class="value-item" onclick="selectValue(this)" data-value="freedom">Libertad</div>
                </div>
            </div>
        </div>

        <!-- Test 3: Conexión Trascendental -->
        <div class="spiritual-area" id="area3">
            <h2 class="area-title">Test 3: Conexión Trascendental</h2>
            <div class="spiritual-question">
                <div class="question-text">
                    ¿Cómo describes tu conexión con algo más grande que tú mismo?
                </div>
                <div class="spiritual-options">
                    <div class="spiritual-option" onclick="selectSpiritual(3, 1)" data-score="100">
                        Siento una profunda conexión con el universo, la humanidad y la conciencia colectiva
                    </div>
                    <div class="spiritual-option" onclick="selectSpiritual(3, 2)" data-score="80">
                        Tengo una fuerte conexión espiritual que me da paz y dirección
                    </div>
                    <div class="spiritual-option" onclick="selectSpiritual(3, 3)" data-score="60">
                        A veces siento conexión con algo más grande, especialmente en la naturaleza
                    </div>
                    <div class="spiritual-option" onclick="selectSpiritual(3, 4)" data-score="40">
                        Estoy abierto a la espiritualidad pero no he encontrado mi camino
                    </div>
                    <div class="spiritual-option" onclick="selectSpiritual(3, 5)" data-score="20">
                        No creo en nada más allá de lo material y tangible
                    </div>
                </div>
            </div>
        </div>

        <!-- Test 4: Sabiduría y Virtudes (VIA Character Strengths) -->
        <div class="spiritual-area" id="area4">
            <h2 class="area-title">Test 4: Fortalezas de Carácter (Peterson & Seligman)</h2>
            <div class="spiritual-question">
                <div class="question-text">
                    ¿Cuál consideras tu mayor fortaleza de carácter?
                </div>
                <div class="spiritual-options">
                    <div class="spiritual-option" onclick="selectSpiritual(4, 1)" data-score="100">
                        Sabiduría y amor por el aprendizaje - busco constantemente la verdad y el conocimiento
                    </div>
                    <div class="spiritual-option" onclick="selectSpiritual(4, 2)" data-score="95">
                        Compasión y bondad - me preocupo genuinamente por el bienestar de otros
                    </div>
                    <div class="spiritual-option" onclick="selectSpiritual(4, 3)" data-score="90">
                        Integridad y honestidad - vivo de acuerdo a mis valores sin importar las consecuencias
                    </div>
                    <div class="spiritual-option" onclick="selectSpiritual(4, 4)" data-score="85">
                        Perseverancia y fortaleza - no me rindo ante las dificultades y aprendo de los fracasos
                    </div>
                </div>
            </div>
        </div>

        <!-- Test 5: Orientación al Servicio -->
        <div class="spiritual-area" id="area5">
            <h2 class="area-title">Test 5: Orientación al Servicio</h2>
            <div class="spiritual-question">
                <div class="question-text">
                    Reflexiona sobre tu motivación para unirte a CO•RA:
                </div>
                <textarea class="reflection-input" id="serviceReflection" placeholder="Describe qué te motiva a ser parte de CO•RA y cómo planeas contribuir al crecimiento colectivo de la humanidad..."></textarea>
            </div>
        </div>

        <div class="results-container" id="resultsContainer">
            <h2 style="color: #9b59b6; margin-bottom: 25px;">🌟 Evaluación Espiritual Completada</h2>
            <div id="spiritualResults"></div>
        </div>
    </div>

    <script>
        let currentArea = 1;
        let spiritualScores = {purpose: 0, values: 0, transcendence: 0, wisdom: 0, service: 0};
        let spiritualResponses = {};
        let selectedValues = [];

        function selectSpiritual(area, option) {
            const options = document.querySelectorAll(`#area${area} .spiritual-option`);
            options.forEach(opt => opt.classList.remove('selected'));
            
            const selectedOption = event.target;
            selectedOption.classList.add('selected');
            
            const score = parseInt(selectedOption.dataset.score);
            spiritualResponses[area] = { option, score };
            
            // Actualizar dashboard
            const metrics = ['purpose', 'values', 'transcendence', 'wisdom', 'service'];
            const metricIds = ['purposeScore', 'valuesScore', 'transcendenceScore', 'wisdomScore', 'serviceScore'];
            
            if (area <= 5 && area !== 2 && area !== 5) {
                spiritualScores[metrics[area-1]] = score;
                document.getElementById(metricIds[area-1]).textContent = score;
            }
            
            setTimeout(() => {
                nextArea();
            }, 1000);
        }

        function selectValue(element) {
            if (element.classList.contains('selected')) {
                element.classList.remove('selected');
                selectedValues = selectedValues.filter(v => v !== element.dataset.value);
            } else if (selectedValues.length < 3) {
                element.classList.add('selected');
                selectedValues.push(element.dataset.value);
            }
            
            if (selectedValues.length === 3) {
                // Calcular puntuación basada en valores seleccionados
                const transcendentalValues = ['wisdom', 'justice', 'compassion', 'truth', 'service'];
                const score = selectedValues.filter(v => transcendentalValues.includes(v)).length * 33.33;
                
                spiritualScores.values = Math.round(score);
                document.getElementById('valuesScore').textContent = Math.round(score);
                
                setTimeout(() => {
                    nextArea();
                }, 1500);
            }
        }

        function evaluateService() {
            const reflection = document.getElementById('serviceReflection').value;
            const words = reflection.split(/\s+/).filter(word => word.length > 0);
            
            // Palabras clave que indican orientación al servicio
            const serviceKeywords = ['servir', 'ayudar', 'contribuir', 'humanidad', 'colectivo', 'crecimiento', 'evolución', 'consciencia', 'amor', 'compasión'];
            const serviceWords = words.filter(word => 
                serviceKeywords.some(keyword => word.toLowerCase().includes(keyword))
            );
            
            let serviceScore = Math.min(100, (serviceWords.length / words.length) * 200 + (words.length > 50 ? 20 : 0));
            serviceScore = Math.max(20, serviceScore); // Mínimo 20 por participar
            
            spiritualScores.service = Math.round(serviceScore);
            document.getElementById('serviceScore').textContent = Math.round(serviceScore);
        }

        function nextArea() {
            if (currentArea === 2 && selectedValues.length < 3) {
                return; // No avanzar hasta seleccionar 3 valores
            }
            
            document.getElementById(`area${currentArea}`).classList.remove('active');
            currentArea++;
            
            if (currentArea <= 5) {
                setTimeout(() => {
                    document.getElementById(`area${currentArea}`).classList.add('active');
                }, 500);
            } else {
                evaluateService();
                setTimeout(() => {
                    showResults();
                }, 1000);
            }
        }

        function showResults() {
            document.querySelectorAll('.spiritual-area').forEach(area => area.style.display = 'none');
            
            const overallSpiritual = Object.values(spiritualScores).reduce((a, b) => a + b, 0) / 5;
            const spiritualProfile = determineSpiritualProfile(overallSpiritual, spiritualScores);
            
            document.getElementById('spiritualResults').innerHTML = generateSpiritualResults(spiritualProfile, overallSpiritual);
            document.getElementById('resultsContainer').style.display = 'block';
        }

        function determineSpiritualProfile(overall, scores) {
            const minScore = Math.min(...Object.values(scores));
            
            if (overall >= 85 && minScore >= 70) {
                return {
                    level: 'MAESTRO ESPIRITUAL',
                    color: '#9b59b6',
                    description: 'Profunda conexión espiritual y claridad de propósito. Ideal para guiar a otros en CO•RA.',
                    role: 'Guía Espiritual o Consejero de Sabiduría',
                    path: 'Camino del Maestro - Enseñanza y guía espiritual',
                    nextStep: 'evaluacion_vocacional.html',
                    buttonText: '🎯 EVALUACIÓN VOCACIONAL'
                };
            } else if (overall >= 70 && minScore >= 50) {
                return {
                    level: 'BUSCADOR AVANZADO',
                    color: '#8e44ad',
                    description: 'Sólida base espiritual con propósito claro y valores definidos.',
                    role: 'Miembro activo con potencial de liderazgo espiritual',
                    path: 'Camino del Crecimiento - Desarrollo continuo',
                    nextStep: 'evaluacion_vocacional.html',
                    buttonText: '🎯 EVALUACIÓN VOCACIONAL'
                };
            } else if (overall >= 50) {
                return {
                    level: 'EXPLORADOR ESPIRITUAL',
                    color: '#bb8fce',
                    description: 'En proceso de desarrollo espiritual con apertura al crecimiento.',
                    role: 'Miembro en formación con acompañamiento espiritual',
                    path: 'Camino del Despertar - Exploración y descubrimiento',
                    nextStep: 'desarrollo_espiritual.html',
                    buttonText: '🌱 DESARROLLO ESPIRITUAL'
                };
            } else {
                return {
                    level: 'INICIANTE ESPIRITUAL',
                    color: '#d7bde2',
                    description: 'Necesario desarrollo de conexión espiritual y claridad de propósito.',
                    role: 'Preparación espiritual antes de integración completa',
                    path: 'Camino de la Preparación - Fundamentos espirituales',
                    nextStep: 'preparacion_espiritual.html',
                    buttonText: '🕯️ PREPARACIÓN ESPIRITUAL'
                };
            }
        }

        function getValuesDescription() {
            const valueDescriptions = {
                wisdom: 'Sabiduría',
                justice: 'Justicia',
                compassion: 'Compasión',
                truth: 'Verdad',
                service: 'Servicio',
                growth: 'Crecimiento',
                harmony: 'Armonía',
                freedom: 'Libertad'
            };
            return selectedValues.map(v => valueDescriptions[v]).join(', ');
        }

        function generateSpiritualResults(profile, overall) {
            return `
                <div style="background: rgba(155, 89, 182, 0.2); padding: 25px; border-radius: 15px; margin: 20px 0;">
                    <h3 style="color: ${profile.color}; margin-bottom: 15px;">
                        Perfil Espiritual: ${profile.level}
                    </h3>
                    <p style="margin-bottom: 15px; line-height: 1.6;">
                        ${profile.description}
                    </p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 15px; margin: 20px 0;">
                        <div style="background: rgba(0,0,0,0.6); padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="color: #9b59b6; font-weight: bold;">Propósito</div>
                            <div style="font-size: 1.3rem; color: white;">${spiritualScores.purpose}</div>
                        </div>
                        <div style="background: rgba(0,0,0,0.6); padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="color: #9b59b6; font-weight: bold;">Valores</div>
                            <div style="font-size: 1.3rem; color: white;">${spiritualScores.values}</div>
                        </div>
                        <div style="background: rgba(0,0,0,0.6); padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="color: #9b59b6; font-weight: bold;">Trascendencia</div>
                            <div style="font-size: 1.3rem; color: white;">${spiritualScores.transcendence}</div>
                        </div>
                        <div style="background: rgba(0,0,0,0.6); padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="color: #9b59b6; font-weight: bold;">Sabiduría</div>
                            <div style="font-size: 1.3rem; color: white;">${spiritualScores.wisdom}</div>
                        </div>
                        <div style="background: rgba(0,0,0,0.6); padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="color: #9b59b6; font-weight: bold;">Servicio</div>
                            <div style="font-size: 1.3rem; color: white;">${spiritualScores.service}</div>
                        </div>
                    </div>
                    
                    <div style="background: rgba(0,0,0,0.6); padding: 20px; border-radius: 15px; margin: 20px 0;">
                        <h4 style="color: #9b59b6; margin-bottom: 10px;">💎 Valores Fundamentales:</h4>
                        <p style="margin-bottom: 10px;">${getValuesDescription()}</p>
                        
                        <h4 style="color: #9b59b6; margin-bottom: 10px;">🏛️ Rol Espiritual en CO•RA:</h4>
                        <p style="margin-bottom: 10px;">${profile.role}</p>
                        
                        <h4 style="color: #9b59b6; margin-bottom: 10px;">🛤️ Camino de Desarrollo:</h4>
                        <p>${profile.path}</p>
                    </div>
                    
                    <div style="background: rgba(155, 89, 182, 0.1); padding: 15px; border-radius: 10px; margin: 15px 0;">
                        <strong>Puntuación Espiritual Integral:</strong> ${Math.round(overall)}/100
                    </div>
                </div>
                
                <div style="text-align: center; margin: 30px 0;">
                    <a href="${profile.nextStep}" style="
                        background: linear-gradient(135deg, ${profile.color}, #bb8fce);
                        color: white;
                        padding: 20px 40px;
                        border-radius: 25px;
                        text-decoration: none;
                        font-weight: bold;
                        font-size: 1.2rem;
                        display: inline-block;
                    ">${profile.buttonText}</a>
                    
                    <p style="margin-top: 15px; color: #bb8fce; font-size: 0.9rem;">
                        Tu desarrollo espiritual determina tu camino de crecimiento en CO•RA
                    </p>
                </div>
            `;
        }
    </script>
    <script src="token_manager.js"></script>
    <script src="analytics_engine.js"></script>
</body>
</html>